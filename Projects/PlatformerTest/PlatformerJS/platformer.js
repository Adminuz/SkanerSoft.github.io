var PlatformerJS=function(e){var d=this,f=e.vector.point,h=e.vector.size,g=e.OOP,c=[];d.onCellDestroy=!1;d.autoDraw=!0;d.player={id:-1};this.addAction=function(a){a.speed||(a.speed=f(0,0));a.maxSpeed||(a.maxSpeed=f(0,0));a.mass||(a.mass=0);if(!a.friction||0>=a.friction)a.friction=0;a.gravity||(a.gravity=f(0,0));a.plType=10;a.jumped=!1;a.jump=function(b){a.jumped||(a.jumped=!0,a.speed.y=-b)};c.push(a)};this.addSprite=function(a){a.plType=0;c.push(a)};this.addFloor=function(a){a.plType=1;c.push(a)};
this.addWall=function(a){a.plType=2;c.push(a)};this.addCell=function(a){a.motionPosition=a.getPositionC();a.jumpSpeed||(a.jumpSpeed=0);a.plType=3;c.push(a)};this.update=function(){g.forArr(c,function(a){10==a.plType?(a.friction&&(0<a.speed.x?(a.speed.x-=a.friction,Math.abs(a.speed.x)<2*a.friction&&(a.speed.x=0)):0>a.speed.x&&(a.speed.x+=a.friction,Math.abs(a.speed.x)<2*a.friction&&(a.speed.x=0)),0<a.speed.y?(a.speed.y-=a.friction,Math.abs(a.speed.y)<2*a.friction&&(a.speed.y=0)):0>a.speed.y&&(a.speed.y+=
a.friction,Math.abs(a.speed.y)<2*a.friction&&(a.speed.y=0))),a.gravity.y&&(a.speed.y+=a.gravity.y),g.forArr(c,function(b,e){if(a.id!=b.id&&b.plType){if(1==b.plType||10==b.plType)a.isStaticIntersect(b.getStaticBox())&&0<a.speed.y&&a.y+a.h-a.speed.y<b.y?(a.speed.y=0,a.y=-a.h+b.y,a.jumped=!1):a.isStaticIntersect(b.getStaticBox())&&0>a.speed.y&&a.y+a.speed.y>b.y+a.h&&(a.speed.y*=-.1,a.y=b.y+b.h,a.jumped=!0);(2==b.plType||10==b.plType)&&a.y+a.h>b.y&&(a.isStaticIntersect(b.getStaticBox())&&0<a.speed.x&&
a.x+a.w-a.speed.x<b.x?(a.speed.x=0,a.x=-a.w+b.x):a.isStaticIntersect(b.getStaticBox())&&0>a.speed.x&&a.x-a.speed.x>b.x+b.w&&(a.x-=a.speed.x,a.speed.x=0));if(3==b.plType&&d.player.id==a.id&&a.isStaticIntersect(b.getStaticBox())&&(c.splice(e,1),d.onCellDestroy))d.onCellDestroy(b)}}),a.maxSpeed.x&&a.speed.x>a.maxSpeed.x&&(a.speed.x=a.maxSpeed.x),a.maxSpeed.y&&a.speed.y>a.maxSpeed.y&&(a.speed.y=a.maxSpeed.y),a.speed.x&&(a.x+=a.speed.x),a.speed.y?(a.jumped=!0,a.y+=a.speed.y):a.jumped=!1):3==a.plType&&
a.motionC(a.motionPosition,h(0,2.5),a.jumpSpeed||3);d.autoDraw&&a.draw()})}};